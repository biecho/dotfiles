# =============================================================================
# Yazi Configuration
# =============================================================================
# Docs: https://yazi-rs.github.io/docs/configuration/yazi

[manager]
# Show file sizes in listing
linemode = "size"

# Show hidden files by default (toggle with '.')
show_hidden = true

# Natural sorting (1, 2, 10 instead of 1, 10, 2)
sort_by = "natural"
sort_sensitive = false
sort_reverse = false
sort_dir_first = true

# Show symlink targets
show_symlink = true

# Scrolloff - keep cursor away from edges
scrolloff = 5

[preview]
# Wrap text in preview
wrap = "yes"

# Max preview dimensions
max_width = 1000
max_height = 1000

# Image preview (works great in Kitty)
image_delay = 30

[opener]
# Edit files with nvim
edit = [
    { run = 'nvim "$@"', block = true, desc = "Edit with Neovim" },
]

# Open in VS Code
code = [
    { run = 'code "$@"', orphan = true, desc = "Open in VS Code" },
]

# Play media
play = [
    { run = 'mpv --force-window "$@"', orphan = true, desc = "Play with mpv" },
    { run = 'open "$@"', orphan = true, desc = "Open with default app" },
]

# View images
view = [
    { run = 'open "$@"', orphan = true, desc = "Open with Preview" },
]

# Extract archives
extract = [
    { run = 'unar "$1"', desc = "Extract here" },
]

[open]
rules = [
    # Folders
    { name = "*/", use = [ "edit", "code" ] },

    # Text/code files - edit with nvim
    { mime = "text/*", use = [ "edit", "code" ] },
    { mime = "application/json", use = [ "edit", "code" ] },
    { mime = "application/x-yaml", use = [ "edit", "code" ] },
    { mime = "application/toml", use = [ "edit", "code" ] },
    { mime = "application/xml", use = [ "edit", "code" ] },
    { mime = "application/javascript", use = [ "edit", "code" ] },
    { mime = "application/x-sh", use = [ "edit", "code" ] },

    # Images
    { mime = "image/*", use = [ "view" ] },

    # Videos/Audio
    { mime = "video/*", use = [ "play" ] },
    { mime = "audio/*", use = [ "play" ] },

    # Archives
    { mime = "application/zip", use = [ "extract" ] },
    { mime = "application/gzip", use = [ "extract" ] },
    { mime = "application/x-tar", use = [ "extract" ] },
    { mime = "application/x-bzip2", use = [ "extract" ] },
    { mime = "application/x-7z-compressed", use = [ "extract" ] },
    { mime = "application/x-rar", use = [ "extract" ] },

    # Fallback
    { name = "*", use = [ "edit", "code" ] },
]

[tasks]
# Concurrent tasks
micro_workers = 10
macro_workers = 25
bizarre_retry = 5

[plugin]
# Prepend plugins for fetching file info
prepend_fetchers = [
    { id = "git", name = "*", run = "git" },
    { id = "git", name = "*/", run = "git" },
]

# Prepend previewers
prepend_previewers = [
    { name = "*.md", run = "glow", sync = true },
]
